extends ../layouts/application

block header
  .container.row
      .col-auto
        h1= 'Задачи'
      .col-auto
        if isAuthenticated()
          a.btn.btn-primary.ml-auto(href=route('newTask'))= t('views.tasks.index.create')
block content
  form.form-inline.mb-2(action=route('tasks'), method='get')
      .col-auto.form-group
        label(for='statusSelect')= 'Статус'
        select.ml-2.form-control(class="form-control", name='status_id', id='statusSelect')
          option
          each status in statuses
            option(value=status.id)= `${status.name}`
      .col-auto.form-group
          label(for='labelsSelect')= 'Метки'    
          select.ml-2(class="form-control", name='labels_id', id='labelsSelect')
            option
            each label in labels
              option(value=label.id)= `${label.name}`
      .col-auto.form-group
          label(for='executorSelect')= 'Исполнитель'
          select.ml-2(class="form-control", name='executor_id', id='executorSelect')
            option
            each user in users
              option(value=user.id)= `${user.fullName()}`
      .col-auto.form-check
          label(class="form-check-label" for="check")= 'Мои задачи'
          input.ml-2(class="form-check-input" type="checkbox" name='isCreatorUser' id="check")
      .col-auto.form-group
        input.btn.btn-primary.col-auto(type='submit', value='Показать')
  table.table
    thead
      tr
        th(scope='col')= t('views.tasks.index.id')
        th(scope='col')= t('views.tasks.index.name')
        th(scope='col')= t('views.tasks.index.description')
        th(scope='col')= t('views.tasks.index.status_id')
        th(scope='col')= t('views.tasks.index.labels')
        th(scope='col')= t('views.tasks.index.creator_id')
        th(scope='col')= t('views.tasks.index.executor_id')
        th(scope='col')= t('views.tasks.index.createdAt')
        th(scope='col')= t('views.tasks.index.updatedAt')
        th(scope='col')= ''
        th(scope='col')= ''
    tbody
      each task in tasks
        tr
          td= task.id
          td= task.name
          td= task.description
          td= task.status.name
          td= task.labels.map((label) => label.name).join(', ')
          td= task.creator === null ? '' : task.creator.fullName()
          td= task.executor === null ? '' : task.executor.fullName()  
          td= task.createdAt
          td= task.updatedAt
          td
            a.btn.btn-sm.btn-outline-warning(href=`/tasks/${task.id}/edit`)= t('views.tasks.index.edit')
          td  
            form(action=`/tasks/${task.id}` method='post')
              input(type='hidden' name='_method' value='delete')
              input.btn.btn-sm.btn-outline-danger(type='submit' value= t('views.tasks.index.delete'))